var I=Object.defineProperty;var U=(t,e,r)=>e in t?I(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var u=(t,e,r)=>U(t,typeof e!="symbol"?e+"":e,r);import{r as o,j as s,u as z}from"./index-CmY12fDJ.js";function C(){const[t,e]=o.useState(null),r=o.useCallback(a=>{e(a)},[]);return[t,r]}const d=class d{constructor(e,r,a){u(this,"success");u(this,"error");u(this,"value");this.success=e,this.error=r,this.value=a}};u(d,"success",e=>new d(!0,null,e)),u(d,"failed",e=>new d(!1,e,null));let n=d;class y{static registration(e){if(typeof e!="string")return n.failed(new Error("The username must be a string."));const r=e.length;return r<1||r>14?n.failed(new Error("The username length must be equal to or greater than 7 and equal to or less than 14.")):/^[a-zA-Z0-9]+$/.test(e)?n.success(null):n.failed(new Error("The username must only contain letters and/or numbers."))}}class k{static registration(e){if(typeof e!="string")return n.failed(new Error("The password must be a string."));const r=e.length;return r<7||r>22?n.failed(new Error("The password must be equal to or greater than 7 and equal to or less than 22.")):/^[a-zA-Z0-9]+$/.test(e)?/[a-z]/.test(e)?/[A-Z]/.test(e)?/[0-9]/.test(e)?n.success(null):n.failed(new Error("The password must contain at least one number.")):n.failed(new Error("The password must contain at least one uppercase letter.")):n.failed(new Error("The password must contain at least one lowercase letter.")):n.failed(new Error("The password must only contain letters and/or numbers."))}}function A({formLabel:t,submitLabel:e,children:r,onSubmit:a}){return s.jsx("form",{onSubmit:a,children:s.jsxs("fieldset",{children:[s.jsx("legend",{children:t}),r,s.jsx("button",{type:"submit",children:e??"Submit"})]})})}function F(){return s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"size-6",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})]})}function Z(){return s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"size-6",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"})})}function q(){const[t,e]=o.useState(!1),[r,a]=C(),[f,h]=C(),p=o.useId(),w=o.useId(),E=o.useCallback(i=>{const{success:c,error:l}=y.registration(i.target.value);if(c)return a(null);a(l.message)},[a]),v=o.useCallback(()=>{e(i=>!i)},[]),L=o.useCallback(i=>{const c=i.target.value;if(c.length<7)return;const{success:l,error:m}=k.registration(c);if(l)return h(null);h(m.message)},[h]),S=o.useCallback(i=>{i.preventDefault();const c=new FormData(i.target),{name:l,password:m}=Object.fromEntries(c),x=y.registration(l);if(!x.success)return a(x.error.message);const j=k.registration(m);if(!j.success)return h(j.error.message);(async()=>{try{const g=await fetch("/api/users/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:l,password:m})}),{ok:T,status:O}=g,V=await g.json();console.log({dataRegister:V,registerStatus:O,registerOk:T});const b=await fetch("/api/users/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:l,password:m})}),{ok:P,status:N}=b,M=await b.json();console.log({dataLogin:M,loginStatus:N,loginOk:P})}catch(g){console.error(g)}})()},[a,h]);return s.jsx("div",{className:"user-registration",children:s.jsxs(A,{formLabel:"Create account",submitLabel:"Create",onSubmit:S,children:[s.jsxs("section",{children:[s.jsx("label",{htmlFor:p,children:"Username"}),s.jsxs("div",{className:"user-registration__username",children:[s.jsx("input",{id:p,name:"name",type:"text",maxLength:14,autoComplete:"off",spellCheck:!1,placeholder:"Username",onChange:E}),r&&s.jsx("em",{children:r})]})]}),s.jsxs("section",{children:[s.jsx("label",{htmlFor:w,children:"Password"}),s.jsxs("div",{className:"user-registration__password",children:[s.jsxs("div",{children:[s.jsx("input",{id:w,name:"password",type:t?"text":"password",maxLength:22,autoComplete:"off",spellCheck:!1,placeholder:"Password",onChange:L}),s.jsx("button",{type:"button",className:"user-registration__password--visibility-btn",onClick:v,children:t?s.jsx(Z,{}):s.jsx(F,{})})]}),f&&s.jsx("em",{children:f})]})]})]})})}function J(){return s.jsx("div",{style:{alignSelf:"center"},children:s.jsx(q,{})})}function R(){const t=z();return s.jsxs("div",{children:[s.jsx("strong",{children:"error screen:"})," ",s.jsx("p",{children:JSON.stringify(t)??"Unexpected error."})]})}export{R as ErrorBoundary,J as Register};
